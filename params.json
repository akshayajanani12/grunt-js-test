{"name":"Grunt-js-test","tagline":"Grunt plugin to run client-side, mocha unit tests and generate code coverage reports","body":"# Grunt JavaScript Test Runner [![Build Status](https://secure.travis-ci.org/benhutchins/grunt-js-test.png?branch=master)](http://travis-ci.org/benhutchins/grunt-js-test) [![Dependency Status](https://gemnasium.com/benhutchins/grunt-js-test.png)](https://gemnasium.com/benhutchins/grunt-js-test)\r\n\r\ngrunt-js-test is a plugin for [Grunt](http://gruntjs.com/) that is designed to run client-side unit tests using [Mocha](http://visionmedia.github.io/mocha/). You can easily run tests through the command line or a continuous integration suite using PhantomJS or you can pop up a simply server to run your tests in a browser using WebDriver, for development or testing of specific unit tests. grunt-js-test can also generate coverage reports using either [JSCover](https://tntim96.github.io/JSCover/) or [Istanbul](https://gotwarlost.github.io/istanbul/).\r\n\r\n## Getting Started\r\n\r\nThis plugin requires Grunt '~0.4.0'\r\n\r\n```shell\r\nnpm install grunt-js-test --save-dev\r\n```\r\n\r\nOnce the plugin has been installed, it may be enabled inside your Gruntfile with this line of JavaScript:\r\n\r\n```js\r\ngrunt.loadNpmTasks('grunt-js-test');\r\n```\r\n\r\n### Configure your Grunt task\r\n\r\nOpen your `Gruntfile.js` and add your project's configuration as desired (all the options are described below). If you rely on all the defaults, you don't even need to provide anything.\r\n\r\nA few simple example projects are available in the [examples](https://github.com/benhutchins/grunt-js-test/tree/master/examples) directory.\r\n\r\n### Write your tests\r\n\r\nTests are loaded already wrapped up including [Mocha](http://visionmedia.github.io/mocha/), [Chai](http://chaijs.com/) and [Sinon](http://sinonjs.org/). This means you are good to start writing tests immediately.\r\n\r\nA simple example unit test using Mocha:\r\n\r\n```js\r\ndescribe('Array', function(){\r\n  describe('#indexOf()', function(){\r\n    it('should return -1 when the value is not present', function(){\r\n      chai.assert.equal(-1, [1,2,3].indexOf(5));\r\n      chai.assert.equal(-1, [1,2,3].indexOf(0));\r\n    });\r\n  });\r\n});\r\n```\r\n\r\nIf you prefer to use another assert library other than Chai, you can optionally include it as a dependency (see `deps` option below).\r\n\r\n#### Loading dependencies\r\n\r\ngrunt-js-test generates the test HTML page for you, making it quicker to write client-side tests. However, this means that you need a way to load the dependent JavaScript files. grunt-js-test supports [require.js](http://requirejs.org/) projects natively, simply configure the options `requirejs` and `modulesRelativeTo` as needed. If you are not creating a require.js based project, then grunt-js-test implements support for [JScript IntelliSense Reference Tags](http://blogs.msdn.com/b/webdev/archive/2007/11/06/jscript-intellisense-a-reference-for-the-reference-tag.aspx). This allows you to easily load dependencies using a format of:\r\n\r\n```js\r\n/// <reference path=\"../relative/file.js\" />\r\n```\r\n\r\nThere is an example project using these reference tags in our [examples](https://github.com/benhutchins/grunt-js-test/tree/master/examples) directory as [examples/references](https://github.com/benhutchins/grunt-js-test/tree/master/examples/references).\r\n\r\n#### Adding custom HTML to test pages\r\n\r\nAs grunt-js-test generates the test HTML pages for you, on occasion you need to add some HTML to the DOM of the page prior to your JavaScript running. There are two ways to do this, the easiest is to simply create a file named `.inject.html` alongside your test JavaScript file.\r\n\r\nFor example, if you had a test file called `something.unittests.js` you could have a similarly named file `something.unittests.inject.html`, the contents of which would be added to the body of the generated test page.\r\n\r\nThere is an example project using these reference tags in our [examples](https://github.com/benhutchins/grunt-js-test/tree/master/examples) directory as [examples/injectHTML](https://github.com/benhutchins/grunt-js-test/tree/master/examples/injectHTML).\r\n\r\nYou can also reference `.html` files you wish to have injected using a `reference` tags similar to referencing JavaScript dependencies. The format of which is simply:\r\n\r\n```js\r\n/// <reference path=\"../relative/path/to/file/to/inject.html\" />\r\n```\r\n\r\n## Grunt tasks\r\n\r\n### js-test\r\n\r\n_Run this task with the `grunt js-test` command._\r\n\r\nRun all test files with PhantomJS. The minimal config would be:\r\n\r\n```js\r\n  grunt.initConfig({\r\n    'js-test': {\r\n        'default': {\r\n            'options': {}\r\n        }\r\n    }\r\n  });\r\n\r\n  grunt.loadNpmTasks('grunt-js-test');\r\n\r\n  grunt.registerTask('test', ['js-test']);\r\n```\r\n\r\n### js-test-server\r\n\r\n_Run this task with the `grunt js-test-server` command._\r\n\r\nStart a web server on your local host to allow you to run the unit tests individually.\r\n\r\n## Options\r\n\r\n### Command Line Interface Options\r\n\r\n#### --coverage\r\n\r\nPass `--coverage` while running Grunt to turn on coverage with the default `coverageTool`. You can pass a value of a string to select the coverage tool you'd like to use, such as `--coverage=jscover`.\r\n\r\n#### --identifier=\"commit deadbeef\"\r\n\r\nPass `--identifier` with a value of a string you'd like to use as your job identifier. This will be the folder name used when saving your coverage reports to the directory configured with `coverageReportDirectory`. This is useful when using grunt-js-test through continuous integration and want to provide it either the job number or the commit id (or revision number if you're still on SVN).\r\n\r\nBy default a datetime in the format of `YYYY-MM-DD HHMMSS` will be used.\r\n\r\n### Task Options\r\n\r\nAll options of `js-test` are optional, if you specify nothing, it will run all JavaScript files anywhere in your project directory, recursively matching `*.unittests.js`.\r\n\r\n#### root\r\nType: `String`\r\nDefault: `process.cwd()`\r\n\r\nDefines the root path to your project files. A static file web server is started on this path to allow your unit tests to load their dependencies.\r\n\r\n#### pattern\r\nType: `String|Array<String>`\r\nDefault: `**/*.unittests.js`\r\n\r\nGlob search pattern to locate your unit tests. For more information on glob patterns please see [node-glob](https://github.com/isaacs/node-glob). This can optionally be an array of globs which will all be used to find a file matching any of the glob patterns.\r\n\r\n#### include\r\nType: `Array<String|RegExp>`\r\nDefault: `[]`\r\n\r\nArray of simple string searches or regular expression used to whitelist tests. If a test does not match all of these filters it is ignored.\r\n\r\n#### exclude\r\nType: `Array<String|RegExp>`\r\nDefault: `['/node_modules/']`\r\n\r\nArray of simple string searches or regular expressions used to blacklist tests. If a test matches one of these filters it is ignored.\r\n\r\n#### baseUri\r\nType: `String`\r\nDefault: `/`\r\n\r\nBase path used when loading web assets.\r\n\r\n#### deps\r\nType: `Array<String>`\r\nDefault: `[]`\r\n\r\nA list of paths to JavaScript files relative to your `baseUri` you want loaded as global dependencies for each test. You can also include external dependencies, such as `http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.js`.\r\n\r\nDependencies can be injected on a per test file basis using `<reference>` tags. See [loading dependencies](https://github.com/benhutchins/grunt-js-test#loading-dependencies).\r\n\r\n#### referenceTags\r\nType: `Boolean`\r\nDefault: `true`\r\n\r\nLook for `<reference>` tags within unit test files to automatically include additional dependencies. See [loading dependencies](https://github.com/benhutchins/grunt-js-test#loading-dependencies). Usually never hurts to leave it on.\r\n\r\n#### hostname\r\nType: `String`\r\nDefault: `localhost`\r\n\r\nHostname for web server when running the `js-test-server` grunt task.\r\n\r\n#### port\r\nType: `Number`\r\nDefault: `8981`\r\n\r\nPort for web server when running the `js-test-server` grunt task.\r\n\r\n#### staticPort\r\nType: `number`\r\nDefault: `8982`\r\n\r\nPort used for static web server that serves up your unit test dependency files. Should never have to change this unless something else uses this port.\r\n\r\n#### coverageProxyPort\r\nType: `number`\r\nDefault: `8983`\r\n\r\nPort used for proxy web server that instruments your JavaScript files for code coverage reporting. Should never have to change this unless something else uses this port.\r\n\r\n#### mocha\r\nType: `Object`\r\nDefault: `{}`\r\n\r\nObject of options to pass to the [grunt-mocha](https://github.com/kmiyashiro/grunt-mocha/) task. Hopefully you never need to override anything here.\r\n\r\n#### reporter\r\nType: `String`\r\nDefault: `Spec`\r\n\r\nMocha reporter used by `js-test` when reporting to the console.\r\n\r\n#### coverage\r\nType: `Boolean`\r\nDefault: `false`\r\n\r\nShould the test environment generate coverage reports? This can slow down running the tests, but will generate you code coverage reporting data.\r\n\r\n#### coverageTool\r\nType: `String`\r\nDefault: `jscover`\r\n\r\nChoose between either `jscover` or `istanbul` for your coverage instrumentation and reporting service.\r\n\r\n#### coverageReportDirectory\r\nType: `String`\r\nDefault: `process.cwd() + '/coverage'`\r\n\r\nSpecify a directory where coverage report data should be saved.\r\n\r\n#### Filters\r\n\r\nThese filters allow you to narrow down the tests you run via the `js-test` CLI. This is useful when updating a single test or when using grunt-js-test from a continuous integration service.\r\n\r\n    file: null,                     // run only this file, by file name\r\n    re: null,                       // run tests with file names that match this regular expression\r\n    search: null,                   // run tests with file names that contain the string passed (case insensitive)\r\n    bail: false,                    // if true we'll stop running tests once we find a single failure\r\n    grep: false,                    // passed to mocha, runs a regex test on the test descriptions\r\n    log: false,                     // if true, will pass console.log data from phantomjs to node console for debugging\r\n\r\n#### require\r\nType: `Boolean`\r\nDefault: `false`\r\n\r\nThis identifies your project as being a requirejs based project, which means that we do not include your test file directly but instead allow [require.js](http://requirejs.org/) to load it.\r\n\r\n#### modulesRelativeTo\r\nType: `String`\r\nDefault: `null`\r\n\r\nThis defines the path your modules should be relative to, if it's different than your project's `root` directory. Only applicable when your project is a `requirejs` based project.\r\n\r\n#### injectHTML\r\nType: `String`\r\nDefault: `null`\r\n\r\nOptional raw HTML string that added to all of the test pages generated by grunt-js-test. You can load files using this command by using the `fs` module, example: `require('fs').readFileSync('tests/setup.html')`.\r\n\r\n#### injectServer\r\nType: `String`\r\nDefault: `null`\r\n\r\nOptional web server address that provides HTML responses that should be injected into test pages. Similar to ``injectHTML``. This can be used to inject rendered templates into your tests, if needed.\r\n\r\nAn example value would be: `http://localhost:3000/dev/render`\r\n\r\nA request will be made to the url you provide and will provide the test file with it's path relative from the `root` directory as a query string paramater `file`. Example: `?file=test/example.unittests.js`","google":"UA-49219744-2","note":"Don't delete this file! It's used internally to help with page regeneration."}